{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(searchValue, page) {\n  const BASE_URL = 'https://pixabay.com/api';\n  const searchParams = new URLSearchParams({\n    key: '42450434-3c949e4f0cfd845cc919e9207',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n  });\n\n  const res = await axios.get(\n    `${BASE_URL}/?${searchParams}&q=${searchValue}&page=${page}`\n  );\n  \n  return res.data;\n}","export function createMarkup(arr) {\n    return arr\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) =>\n          `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"container-additional-info\">\n          <div class=\"container-descr-inner\">\n            <p class=\"description\">Likes</p>\n            <span class=\"description-value\">${likes}</span>\n          </div>\n          <div class=\"container-descr-inner\">\n            <p class=\"description\">Views</p>\n            <span class=\"description-value\">${views}</span>\n          </div>\n          <div class=\"container-descr-inner\">\n            <p class=\"description\">Comments</p>\n            <span class=\"description-value\">${comments}</span>\n          </div>\n          <div class=\"container-descr-inner\">\n            <p class=\"description\">Downloads</p>\n            <span class=\"description-value\">${downloads}</span>\n          </div>\n        </div>\n      </li>`\n      )\n      .join('');\n  }","import axios from 'axios';\nimport { fetchImages } from './js/pixabay-api';\nimport { createMarkup } from './js/render-function';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\n\nconst params = {\n  formSearch: document.querySelector('.form'),\n  imageList: document.querySelector('.gallery'),\n  preload: document.querySelector('.loader'),\n  nextBtn: document.querySelector('#next-btn'),\n};\n\nconst hiddenClass = 'is-hidden';\nlet page = 0;\nlet searchValue = '';\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nparams.formSearch.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  const searchQuery = event.currentTarget.elements.input.value.trim();\n  const form = event.currentTarget;\n\n  searchValue = searchQuery;\n  page = 1;\n\n  params.nextBtn.classList.add(hiddenClass);\n  params.imageList.innerHTML = '';\n\n  if (!searchQuery) {\n    iziToast.show({\n      title: '❕',\n      theme: 'light',\n      message: `Please, fill in the search field`,\n      messageSize: '20px',\n      messageColor: '#808080',\n      backgroundColor: '#e7fc44',\n      position: 'topRight',\n      timeout: 3000,\n    });\n    return;\n  }\n\n  params.preload.classList.remove(hiddenClass);\n\n  try {\n    const response = await fetchImages(searchValue,page);\n    if (response.hits.length === 0) {\n      iziToast.show({\n        iconUrl: icon,\n        theme: 'dark',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageSize: '16px',\n        messageColor: 'white',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n        timeout: 5000,\n      });\n      form.reset();\n      return;\n    }\n\n    params.imageList.innerHTML = createMarkup(response.hits);\n    gallery.refresh();\n\n    if (response.hits.length >= 15) {\n      addNextPageBtn();\n    }\n\n    scrollBy();\n    form.reset();\n  } catch (err) {\n    handleError(err);\n  } finally {\n    params.preload.classList.add(hiddenClass);\n  }\n}\n\n\nfunction handleError(err) {\n  console.error(err);\n  params.imageList.innerHTML = '';\n  iziToast.show({\n    iconUrl: icon,\n    theme: 'dark',\n    message: err.stack,\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    timeout: 5000,\n  });\n\n  removeNextPageBtn();\n}\n\nasync function nextPage() {\n  params.preload.classList.remove(hiddenClass);\n  removeNextPageBtn();\n  page += 1;\n\n  try {\n    const res = await fetchImages(searchValue,page);\n\n    if (page * 15 >= res.totalHits) {\n      iziToast.show({\n        title: '❕',\n        theme: 'dark',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageSize: '16px',\n        messageColor: 'white',\n        backgroundColor: '#4e75ff',\n        position: 'topRight',\n        timeout: 5000,\n      });\n      params.imageList.innerHTML += createMarkup(res.hits);\n      gallery.refresh();\n      removeNextPageBtn();\n\n      scrollBy();\n\n      return;\n    }\n\n    params.imageList.innerHTML += createMarkup(res.hits);\n    gallery.refresh();\n\n    scrollBy();\n\n    addNextPageBtn();\n  } catch (err) {\n    handleError(err);\n  } finally {\n    params.preload.classList.add(hiddenClass);\n  }\n}\n\nfunction scrollBy() {\n  window.scrollBy({\n    top: 640,\n    behavior: 'smooth',\n  });\n}\n\nfunction addNextPageBtn() {\n  params.nextBtn.classList.remove(hiddenClass);\n  params.nextBtn.addEventListener('click', nextPage);\n}\n\nfunction removeNextPageBtn() {\n  params.nextBtn.classList.add(hiddenClass);\n  params.nextBtn.removeEventListener('click', nextPage);\n}"],"names":["fetchImages","searchValue","page","BASE_URL","searchParams","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","params","hiddenClass","gallery","SimpleLightbox","handleSearch","event","searchQuery","form","iziToast","response","addNextPageBtn","scrollBy","err","handleError","removeNextPageBtn","nextPage","res"],"mappings":"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"}